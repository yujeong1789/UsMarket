<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.mybatis.mapper.member">
	<!-- 회원 등록 -->
	<insert id="insertMember" parameterType="memberDto">
		<!-- <selectKey keyProperty="member_no" resultType="Integer" order="BEFORE">
			select member_seq.nextval from dual
		</selectKey> -->
		insert into member (MEMBER_NO,MEMBER_NAME,MEMBER_ID,MEMBER_PASSWORD,MEMBER_IMAGE,
		MEMBER_EMAIL,MEMBER_HP,MEMBER_REGDATE,MEMBER_STATE_NO,MEMBER_NICKNAME,
		MEMBER_ZIPCODE,MEMBER_ADDRESS,MEMBER_ADDRESS_DETAIL) 
		values (66,#{member_name},#{member_id},#{member_password},#{member_image},
		#{member_email},#{member_hp},SYSDATE,DEFAULT,#{member_nickname},
		#{member_zipcode},#{member_address},#{member_address_detail})
	</insert>

	<!-- 회원 이미지 등록 -->
	<insert id="insertMemberFile" parameterType="memberFileDto">
		INSERT INTO member_img 
		 values(#{member_no}, #{member_img_path}, #{member_img_filename}, #{member_img_uuid}, #{member_img_order}) 
	</insert>

	<!-- 닉네임 중복 검사 -->
	<select id="overlappedNick" parameterType="String" resultType="int">
		select count(MEMBER_NICKNAME) From member where MEMBER_NICKNAME=#{member_nick}
	</select>
	
	<!-- 아이디 중복 검사 -->
	<select id="overlappedID" parameterType="String" resultType="int">
		select count(MEMBER_ID) From member where MEMBER_ID=#{member_id}
	</select>
	
	<!-- 이메일 중복 검사 -->
	<select id="overlappedEmail" parameterType="String" resultType="int">
		select count(MEMBER_EMAIL) From member where MEMBER_EMAIL=#{member_email}
	</select>
	
	<!-- 회원 이미지 등록 -->
	<select id="idLogin" parameterType="String" resultType="map">
		SELECT MEMBER_NO,MEMBER_ID,MEMBER_PASSWORD FROM MEMBER WHERE MEMBER_ID = #{member_id}
	</select>
	
</mapper>